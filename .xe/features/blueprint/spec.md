---
id: blueprint
title: Stack Product Blueprint
author: flanakin
description: "This document defines the what and why of the Stack Product Blueprint feature for architects and engineers. The document is generated by Catalyst AI and reviewed by the feature PM."
dependencies: []
---

<!-- markdownlint-disable single-title -->

# Feature: Stack Product Blueprint

## Problem

Stack needs a comprehensive product roadmap that breaks down the complete product vision into implementable features with clear dependencies, enabling systematic development from proof-of-concept through enterprise scale.

## Goals

- Document all requirements for Stack product across all development phases
- Establish clear feature dependencies to enable parallel development where possible
- Define phased rollout aligned with Product Strategy (POC ‚Üí Mainstream ‚Üí Innovation ‚Üí Platform ‚Üí Enterprise ‚Üí Scale)
- Enable systematic feature implementation via `/catalyst:rollout {feature-id}` workflow
- Achieve complete CLI feature parity with PowerShell prototype in Phase 1

Explicit non-goals:

- Implementing features during blueprint creation (implementation happens after blueprint is approved)
- Detailing Phase 2+ features completely (will be detailed when prior phase completes)
- Changing core PowerShell prototype behavior (preserve existing functionality in Phase 1)

## Scenario

- As a product manager, I need a complete product roadmap so that I can plan releases and communicate progress to stakeholders.
  - Outcome: Blueprint serves as single source of truth for all planned features and requirements across all phases

- As an architect, I need feature dependencies clearly mapped so that I can ensure features are built in the correct order without blocking work.
  - Outcome: Dependency graph enables parallel feature development where dependencies allow

- As an engineer, I need clear feature scope boundaries so that I can implement features without scope creep or ambiguity.
  - Outcome: Each feature has 1-2 sentence scope description with measurable success criteria

- As a team, we need Phase 1 to match PowerShell prototype capabilities so that we achieve complete CLI feature parity.
  - Outcome: All commands, summaries, and workflows from PowerShell prototype are represented as discrete features

## Success Criteria

- All Phase 1 requirements documented with functional and non-functional requirements
- Feature dependency graph is acyclic and organized by system components
- Requirements aligned with Product Strategy from `.xe/product.md`
- Plan.md contains feature breakdown with ID, phase, dependencies, scope, complexity for all Phase 1 features
- Complexity estimates are realistic (Small: 1-2 days, Medium: 3-5 days, Large: 1-2 weeks)
- Phase 2-4 requirements outlined at high level
- Blueprint captures all PowerShell prototype capabilities from `../todo/.xe/specs`

## Design principles

- **Complete feature parity first**
  > Phase 1 must implement ALL capabilities from the PowerShell prototype. No features can be deferred to later phases if they exist in the prototype. This ensures the Node.js CLI can fully replace the PowerShell version.

- **Granular feature decomposition**
  > Break features into small, independently testable units following Single Responsibility Principle. Each feature should do one thing well and be independently implementable via `/catalyst:rollout`.

- **Dependency-driven organization**
  > Organize features by system components (CLI, Commands, Summaries, Domain Logic, Data Layer, Automation) rather than implementation order. This enables maximum parallelization while respecting technical constraints.

## Requirements

### Functional Requirements

**FR-1**: Stack MUST provide CLI commands for task initialization and management

- System MUST allow users to initialize Stack in a Git repository
- Users MUST be able to create new projects with Active/Next/Backlog structure
- Users MUST be able to add tasks to projects with automatic placement in correct section
- System MUST validate task input and commit changes to Git with descriptive messages

**FR-2**: Stack MUST provide CLI commands for task status transitions

- Users MUST be able to mark tasks as in-progress using status emoji (üöß)
- Users MUST be able to complete tasks and automatically promote next priority task
- Users MUST be able to park tasks temporarily and promote next task to top of stack
- Users MUST be able to resume parked or suspended tasks
- Users MUST be able to suspend tasks to exclude from active displays
- System MUST preserve task hierarchy and content during all status transitions

**FR-3**: Stack MUST provide CLI commands for task property updates

- Users MUST be able to update task properties (priority, impact, effort, time blocks)
- Users MUST be able to set specific task metadata with validation
- System MUST preserve task structure and commit changes to Git

**FR-4**: Stack MUST provide CLI command for removing completed tasks

- Users MUST be able to remove completed and skipped tasks from project files
- System MUST preserve file structure and commit with summary of removed tasks

**FR-5**: Stack MUST generate summary files showing prioritized task views

- System MUST generate README.md with prioritized task overview across all projects
- System MUST generate projects.md with project status overview and task counts
- System MUST generate stack.md with comprehensive view of all tasks and metadata
- System MUST generate my-day.md showing current day focus based on time blocks and capacity
- System MUST regenerate all summaries automatically after any task change
- Summaries MUST use emoji status indicators and intelligent task ordering

**FR-6**: Stack MUST calculate task priority scores using configurable weights

- System MUST support configurable emoji weights for Priority, Status, Effort, Impact, TimeBlocks, Special categories
- System MUST support project-level priority bonuses
- System MUST support placement-based scoring
- System MUST support hierarchical emoji aggregation (task scores include subtask scores)
- Priority calculation MUST be deterministic and reproducible

**FR-7**: Stack MUST provide time block and capacity management

- System MUST support named time periods with day/time definitions
- System MUST support emoji assignments for time blocks
- System MUST support capacity allocations for workload planning
- System MUST filter tasks based on time block availability
- Time block configuration MUST be stored in centralized config

**FR-8**: Stack MUST provide centralized configuration management

- System MUST store all settings in `.xe/config/stack.json`
- Configuration MUST include time blocks, emoji weights, task scoring parameters
- Configuration MUST be created during initialization with sensible defaults
- Configuration MUST be version-controlled with Git

**FR-9**: Stack MUST parse and manipulate markdown task files

- System MUST parse markdown with emoji status indicators
- System MUST extract task metadata from markdown
- System MUST preserve document structure during updates
- System MUST support nested subtasks
- System MUST generate valid markdown from task objects

**FR-10**: Stack MUST persist tasks in markdown files

- Tasks MUST be stored in `tasks/` directory with one file per project
- System MUST maintain file structure and formatting
- System MUST read and write tasks atomically to prevent corruption
- All task changes MUST be committed to Git with descriptive messages

**FR-11**: Stack MUST provide core task lifecycle operations

- System MUST support create/update/delete operations
- System MUST validate status transitions
- System MUST preserve nested task structure
- System MUST orchestrate Git commits with descriptive messages for all changes

**FR-12**: Stack MUST track task metadata and timestamps

- System MUST track task properties across all task files
- System MUST track start dates when tasks begin
- System MUST maintain start date history for time tracking
- Metadata MUST be stored in structured format within markdown

**FR-13**: Stack MUST provide GitHub Actions integration

- System MUST generate `.github/workflows/stack-summary.yml` during initialization
- Workflow MUST trigger on push to main branch
- Workflow MUST regenerate all summaries and commit updates back to repository
- Workflow MUST use same summary generation logic as CLI

**FR-14**: Stack MUST provide npm script integration

- System MUST provide CLI access via `npm run {command}`
- Scripts MUST prompt interactively for required parameters
- Integration MUST be consistent with Stack automation patterns

**FR-15**: Stack MUST provide Claude Code command integration

- System MUST enable AI-assisted execution via `/stack:{command}` commands
- Commands MUST provide guided parameter collection
- Commands MUST include usage examples and help text

**FR-16**: Stack blueprint MUST document Phase 2 (Mainstream) requirements at high level

- System MUST support web application with GitHub OAuth authentication
- System MUST provide visual task management interface with drag-and-drop
- System MUST support real-time summary updates in web interface
- System MUST support GitHub Pages deployment

**FR-17**: Stack blueprint MUST document Phase 3 (Innovation) requirements at high level

- System MUST support AI-powered auto-prioritization based on context and patterns
- System MUST support intelligent task breakdown with dependency analysis
- System MUST support AI-powered effort and impact estimation
- System MUST support natural language task creation and parsing
- System MUST provide context-aware execution suggestions
- System MUST support smart scheduling with AI-powered calendar optimization

**FR-18**: Stack blueprint MUST document Phase 4 (Scale) requirements at high level

- System MUST support iOS and Android native apps
- System MUST provide offline-first architecture with bidirectional sync
- System MUST support push notifications for task reminders
- System MUST support voice input for quick task capture

### Non-functional requirements

**NFR-1**: Cost & usage efficiency

- Blueprint creation MUST not incur API costs (no external services required)
- Feature scope boundaries MUST prevent scope creep and wasted development effort
- CLI commands MUST complete in under 2 seconds for typical operations
- Summary generation MUST complete in under 5 seconds for repositories with up to 1000 tasks

**NFR-2**: Reliability

- Feature dependencies MUST be accurate to prevent implementation blockers
- Complexity estimates MUST be realistic to enable accurate project planning
- All Phase 1 features MUST map to PowerShell prototype capabilities (no missing features)
- Task file corruption MUST be prevented through atomic writes
- Git operations MUST handle conflicts gracefully with clear error messages

**NFR-3**: Performance

- Blueprint document MUST be readable and navigable
- Task scoring MUST scale to 1000+ tasks without noticeable delay
- Summary generation MUST be incremental where possible
- File I/O MUST be minimized through caching

**NFR-4**: Observability

- Each feature MUST have clear scope description for status tracking
- Tasks.md MUST provide checklist for implementation progress
- CLI commands MUST provide clear progress indicators for long-running operations
- Error messages MUST be actionable and include context

**NFR-5**: Testability

- Each feature MUST be independently testable
- Task operations MUST be testable without Git repository
- Summary generation MUST be testable with fixture data
- Markdown parsing MUST handle malformed input gracefully

**NFR-6**: Security

- Git credentials MUST never be logged or exposed
- Configuration files MUST not contain secrets
- GitHub OAuth tokens MUST be stored securely (Phase 2+)

**NFR-7**: Backward compatibility

- Phase 1 features MUST preserve PowerShell prototype behavior
- Blueprint structure MUST follow Catalyst template format for consistency
- Configuration changes MUST include migration path
- Summary file format changes MUST not break existing workflows

## Key Entities

Entities owned by this feature:

- **Task**: Unit of work with status emojis (üö®, ‚ÄºÔ∏è, üî∫, üöß, ‚è∏Ô∏è, ‚õî, ‚è≥, üëÄ, üîÑ, üìÖ, ‚úì, ‚è≠Ô∏è), priority, impact, effort, time block metadata, and nested subtask support
- **Project**: Collection of tasks organized into Active/Next/Backlog sections with project-level metadata and priority
- **TimeBlock**: Named time periods with day/time definitions, emoji assignments, and capacity allocations for workload planning
- **Summary**: Generated overview files (README.md, projects.md, stack.md, my-day.md) showing prioritized tasks and project status
- **Configuration**: System settings in `.xe/config/stack.json` including time blocks, emoji weights, task scoring parameters
- **Feature**: Discrete, independently implementable unit of functionality with ID, phase, dependencies, scope description, complexity estimate (documented in plan.md)
- **Feature Dependency Graph**: Directed acyclic graph showing which features depend on others, organized by system components (documented in plan.md)

Entities from other features:

- **Product Strategy** (product): Phase prioritization defining product development sequence (POC ‚Üí Mainstream ‚Üí Innovation ‚Üí Platform ‚Üí Enterprise ‚Üí Scale)
- **PowerShell Prototype Features** (external): Existing feature specifications in `../todo/.xe/specs` serving as reference implementation for Phase 1 requirements

Inputs:

- Issue #4 describing product vision, user workflows, and feature requirements
- PowerShell prototype feature specs in `../todo/.xe/specs` directory
- Product Strategy from `.xe/product.md` defining phase priorities
- Catalyst template at `node_modules/@xerilium/catalyst/templates/specs/spec.md`

Outputs:

- **spec.md**: This requirements specification with FRs/NFRs, design principles, success criteria
- **plan.md**: Feature breakdown with dependency graph, 27 Phase 1 features + 15 Phase 2-4 features
- **tasks.md**: Checklist of Phase 1 implementation tasks + Phase 2-5 planning tasks
- **research.md**: Product analysis and competitive research findings

## Dependencies

- **Catalyst playbooks**: `start-blueprint.md` playbook defines blueprint creation workflow
- **PowerShell prototype**: Feature specs in `../todo/.xe/specs` define reference implementation for Phase 1 requirements
- **Product context**: `.xe/product.md` defines Product Strategy phase priorities
- **Catalyst templates**: `node_modules/@xerilium/catalyst/templates/specs/` define spec structure
